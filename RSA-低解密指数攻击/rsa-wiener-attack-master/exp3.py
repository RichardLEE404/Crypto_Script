#!/usr/bin/python
#coding:utf-8

import gmpy2
from Crypto.PublicKey import RSA
import ContinuedFractions, Arithmetic
from Crypto.Util.number import long_to_bytes 

def wiener_hack(e, n):
    frac = ContinuedFractions.rational_to_contfrac(e, n)
    convergents = ContinuedFractions.convergents_from_contfrac(frac)
    for (k, d) in convergents:
        if k != 0 and (e * d - 1) % k == 0:
            phi = (e * d - 1) // k
            s = n - phi + 1
            discr = s * s - 4 * n
            if (discr >= 0):
                t = Arithmetic.is_perfect_square(discr)
                if t != -1 and (s + t) % 2 == 0:
                    print("Hacked!")
                    return d
    return False

n = 27095092265228455559753374846908208269693749201259066707026422342846240899312888856144977950103606252326997146532795812667413484858960658534630685322061423987180043129644048742526742685421439020900063588188447508859853976545619874425436979696509052221954308185951718529548621268976109730643596717755491648313751864616728248967237821072089548205791938406421484520861041357000849334077862381867413306276179778988398391205991248204831526701343220559004456032503045618503806089918337904046367229019693446234684306585431146407070149115157350825009817051379059916285496965000971048352724610192668946112976599821740052295380410711040077278005186518536348381895705221417595340621339123852094419627219674246462811634565539843591824514631939436503304125907808736871425002836542343786352210747117842571013681126593219109926162937204080560689164780754502242348241018670467670425372640988597501523125991240501343242501982975624258035773929669538874123789204952740469922548928056076751759792838381290969645882423923330581124803204680414171861507879982842931300191471401385485528483087955884673739718474326459350356905452429620622654679315559925679115072288395254009897799819171867398266143943043589878979818705721765420003895360966625352539939043615099483085581713052439620910266170511437980855428852408998288793402478050649494951142286124868877334225344610058865215290391923430543650880908193897010237627329829978913911552923430793847503292115029232232003847208962164118174848285211071279359601094881723467947965984717258730532119245417987824211939335051
e = 2
c = 10888055509727258560565465125968679310974885892130532351364353213363679678473997485162919565674075426868358277633068952855401713648228506538686933675438059892899393342844929599432887944649559303791793514829398558624389891965575991914701733597580754262139668970226187943190412652173753855197166676880016341300835129359418827797930909615457343052565572415235215866863195839653303135231242638779684340760614694512206443406102946098264526225906957670700454954887028560287494933780678225695036871461503484992244228564852182113220104147070445888380792285649211944475344132012714278461739653800358101128996986775249703146415101686960680580432414571304455398476011681771003585931580177009227561116212060871130637689731709775169747810402960744719915365030772625348051447911530796168835651916429008610893252345905094092719740382452875832470541668835918780738322737804487359539516666438222512794401233653697390613362213784634037213814434298312748196150193956613287365300253134386216404890383802585110240037537152654031001814594925111001212934374759279211079420418720753970069272518973258659083677023762976029623703010264545539020630734355228771151159189333086240638422209070261368482426219776394804114174206890997806478513372540425916951087380402577223771076175252282287792981375478446790641435467130200959799711230804146771622663161458193139082585895004467236080989368955390523727504405415730573160691419925381231378568235536994998154011325966255294054290421777366941333837719420747289886474932798466524333117045007094593170591614895917886428504167144
d = wiener_hack(e, n)
m = pow(c,d,n)
print(long_to_bytes(m))